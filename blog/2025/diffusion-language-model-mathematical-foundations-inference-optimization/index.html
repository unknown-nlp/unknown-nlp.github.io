<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Diffusion Language Model-Mathematical foundations &amp; inference optimization | You R. Name </title> <meta name="author" content="You R. Name"> <meta name="description" content=" ë…¼ë¬¸ ë¦¬ë·° - Diffusion Language Model-Mathematical foundations &amp; inference optimization"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/al-folio/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/al-folio/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/al-folio/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/al-folio/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://alshedivat.github.io/al-folio/blog/2025/diffusion-language-model-mathematical-foundations-inference-optimization/"> <script src="/al-folio/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/al-folio/"> <span class="font-weight-bold">You</span> R. Name </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/al-folio/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/al-folio/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/people/">people </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/al-folio/books/">bookshelf</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/al-folio/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Diffusion Language Model-Mathematical foundations &amp; inference optimization</h1> <p class="post-meta"> Created on January 02, 2025 </p> <p class="post-tags"> <a href="/al-folio/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a> Â  Â· Â  <a href="/al-folio/blog/tag/llm"> <i class="fa-solid fa-hashtag fa-sm"></i> llm</a> Â  <a href="/al-folio/blog/tag/paper-review"> <i class="fa-solid fa-hashtag fa-sm"></i> paper-review</a> Â  <a href="/al-folio/blog/tag/nlp"> <i class="fa-solid fa-hashtag fa-sm"></i> nlp</a> Â  Â· Â  <a href="/al-folio/blog/category/paper-reviews"> <i class="fa-solid fa-tag fa-sm"></i> paper-reviews</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p><strong>ë…¼ë¬¸ ì •ë³´</strong></p> <ul> <li> <strong>Date</strong>: 2025-01-02</li> <li> <strong>Reviewer</strong>: ê¹€ì¬í¬</li> <li> <strong>Property</strong>: DiffusionLM, Pre-training</li> </ul> <p>ğŸ’¡ masked diffusion language modelì˜ ìˆ˜í•™ì  ê¸°ì´ˆë¥¼ ë‹¤ì§„ ë…¼ë¬¸ì— ëŒ€í•´ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p> <p><a href="https://arxiv.org/abs/2406.07524" rel="external nofollow noopener" target="_blank">https://arxiv.org/abs/2406.07524</a></p> <ul> <li> <p>Forward process: ì›ë³¸ ë°ì´í„°ì— ëŒ€í•´ ì¼ì • ë¹„ìœ¨ì˜ ë…¸ì´ì¦ˆë¥¼ ì…ë ¥í•˜ì—¬ í›¼ì†í•˜ëŠ” ê³¼ì •</p> <ul> <li> <p>ìµœëŒ€ Të²ˆ ë°˜ë³µ</p> </li> <li> <p>scherduler: step tì—ì„œ ìœ ì§€í•  ì •ë³´ì˜ ìˆ˜ì¤€ì„ ì •í•¨ or ì…ë ¥í•  ë…¸ì´ì¦ˆì˜ ìˆ˜ì¤€</p> </li> <li> <p>prior: ë…¸ì´ì¦ˆê°€ ìƒ˜í”Œë§ë˜ëŠ” ë¶„í¬ or ìƒì„± ì‹œ ê°€ì¥ ì²« ì‹œì ($ t=T $)ì˜ ë°ì´í„° ë¶„í¬</p> </li> </ul> </li> <li> <p>Backward process: të²ˆ í›¼ì†ëœ ë°ì´í„°ì— ëŒ€í•˜ì—¬ së²ˆ í›¼ì†ëœ ë°ì´í„°ë¡œ ë³µì›í•˜ëŠ” ê³¼ì • $ (t &gt; s) $</p> <ul> <li>ì‹¤ì œ ëª¨ë¸ì˜ í•™ìŠµ ëŒ€ìƒ â†’ ì™„ì „í•œ ë…¸ì´ì¦ˆ ë°ì´í„°ì—ì„œ ì‹¤ì œ ë°ì´í„°ë¥¼ ìƒì„±(ìƒ˜í”Œë§) í•  ìˆ˜ ìˆê²Œ ë¨</li> </ul> </li> <li> <p>training objective function</p> <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>  - ì›ë˜ objective function$ (- \log p_{\theta}(x_0)) $ì€ í•„ìš”í•œ ê³„ì‚°ì´ ë„ˆë¬´ ë§ìŒ

  - ì™„ì „í•œ ë…¸ì´ì¦ˆ(x_T)ë¶€í„° Tê°œì˜ ëª¨ë“  ìŠ¤í…ì— ëŒ€í•´ 1) ë…¸ì´ì¦ˆë¥¼ ê°€í•˜ê³  2) ëª¨ë¸ì„ í†µí•´ ë³µì›í•˜ëŠ” ê³¼ì •ì„ ìˆ˜í–‰í•´ì•¼ í•¨

      â‡’ ë§¤ìš° ì—°ì‚°ëŸ‰/ë©”ëª¨ë¦¬ë¥¼ ë§ì´ ì°¨ì§€í•˜ê²Œ ë¨

  - ì› ëª©ì í•¨ìˆ˜ì˜ ELBoë¥¼ ë³€ë¶„ì¶”ë¡ (ëª°ë¼ìš”â€¦)ì„ í†µí•´ ì‚°ì¶œí•˜ê²Œ ë¨

  - Expectation í•­ìœ¼ë¡œ êµ¬ì„±ë˜ê¸° ë•Œë¬¸ì— ëª¨ë“  step ê³„ì‚°ì´ í•„ìš” ì—†ì–´ì§

          - $ x_0: $ ì‹¤ì œ ë°ì´í„°(ê·¸ëƒ¥ ë°°ì¹˜ë¡œ ê°€ì ¸ì˜¤ëŠ” ê³¼ì •)

  - $ t: $ uniform distì—ì„œ ìƒ˜í”Œë§ (ë§¤ ë°ì´í„°ë§ˆë‹¤ í•˜ë‚˜ì˜ stepì— ëŒ€í•´ì„œë§Œ í•™ìŠµ ì§„í–‰) â‡’ ì› ëª©ì í•¨ìˆ˜ ëŒ€ë¹„ ì—°ì‚°ëŸ‰ì´ ë§¤ìš° ì¤„ì–´ë“¤ê²Œ ë¨.

  - $ \eta:  $ì‹¤ì œ noise, ë§¤ iterë§ˆë‹¤ ë‹¤ë¥¸ noiseë¥¼ ì£¼ì…í•´ì•¼ í•˜ë¯€ë¡œ ìƒˆë¡œ sampling
</code></pre></div> </div> <ul> <li> <p>ì‹¤ì œë¡œëŠ” stepwise denoising termë§Œì„ ì‚¬ìš©í•˜ì—¬ í•™ìŠµì´ ì§„í–‰ë˜ê²Œ ë¨</p> <ul> <li>ì‹¤ì œë¡œ t-1 â†’ t stepì—ì„œ ê°€í•´ì§„ noiseë¥¼ ëª¨ë¸ì´ ì˜ˆì¸¡í•˜ë„ë¡ í•™ìŠµë¨.</li> </ul> </li> </ul> <p><br></p> <p>ğŸ’¡ Diffusion Modelì˜ ì£¼ëœ ì—°êµ¬ ë¶„ì•¼ì¸ ì´ë¯¸ì§€ëŠ” continuousí•œ ë³€ìˆ˜(pixel)ì„ ë‹¤ë£¨ê¸° ë•Œë¬¸ì— ëª¨ë“  ë³€ìˆ˜ ë° ê³¼ì •ì´ ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì§„í–‰ë¨.</p> </li> </ul> <p><br></p> <p>ğŸ’¡ í…ìŠ¤íŠ¸ ë„ë©”ì¸ì— ì ì ˆí•œ diffusion modelingì€ ë¬´ì—‡ì¼ê¹Œ?</p> <h2 id="í…ìŠ¤íŠ¸-ë„ë©”ì¸ì˜-íŠ¹ì§•-ë‡Œí”¼ì…œ">í…ìŠ¤íŠ¸ ë„ë©”ì¸ì˜ íŠ¹ì§• (ë‡Œí”¼ì…œ)</h2> <ol> <li> <p>text: ë§¤ìš° ê³ ë°€ë„ì˜ ì •ë³´ê°€ ë³´ì¡´ëœ ë„ë©”ì¸. ì´ë¯¸ì§€ì™€ ë‹¤ë¥´ê²Œ ì •ë³´ëŸ‰ì´ ê±°ì˜ ì—†ëŠ” ë³€ìˆ˜ê°€ ì ìŒ</p> <p>â‡’ embeddingì— ê°€í•˜ëŠ” ë…¸ì´ì¦ˆëŠ” í¬ê¸°ê°€ ë§¤ìš° ì‘ë”ë¼ë„ í° ì˜ë¯¸ë³€í™”ë¥¼ ë§Œë“¤ì–´ë‚¼ ìˆ˜ ìˆìŒ</p> <ol> <li> <p>discrete: ë‹¨ì–´ëŠ” ì¡´ì¬í•˜ê±°ë‚˜, ì¡´ì¬í•˜ì§€ ì•ŠëŠ” binaryí•œ ë³€ìˆ˜ì„</p> </li> <li> <p>continuousí•œ noiseë¥¼ ì‚½ì…í•˜ëŠ” interpolationì´ ë¶ˆê°€ëŠ¥í•¨</p> </li> <li> <p>embeddingì„ ì´ìš©í•œ diffusion ë°©ë²•ë¡ ì´ ìˆì§€ë§Œ ì•„ì§ê¹Œì§€ëŠ” MDLMì´ ë” ë‚˜ì€ ë°©ë²•ë¡ ìœ¼ë¡œ ë³´ì„</p> </li> </ol> </li> </ol> <p><br></p> <h2 id="ìˆ˜ì‹-ì „ê°œ-discrete-diffusion">ìˆ˜ì‹ ì „ê°œ Discrete Diffusion</h2> <p>$ \textit{V} = $ [ì‚¬ê³¼, ì¡´ë§›íƒ±, mask]</p> <p>ì…ë ¥ë¬¸ì¥: ì‚¬ê³¼ ì¡´ë§›íƒ±</p> <h3 id="forward-process-ë…¸ì´ì¦ˆë¥¼-ì£¼ì…-actual-token--mask">forward process: ë…¸ì´ì¦ˆë¥¼ ì£¼ì…, actual token â†’ mask</h3> <p>$ q\left(\mathbf{z}_t \mid \mathbf{x}\right)=\operatorname{Cat}\left(\mathbf{z}_t ; \alpha_t \mathbf{x}+\left(1-\alpha_t\right) \boldsymbol{\pi}\right) $</p> <ul> <li> <p>Terms</p> <ul> <li> <p>x: ì›ë³¸ í…ìŠ¤íŠ¸(1-hot encoding), [1, 0, 0]</p> </li> <li> <p>$ \alpha_t $: t ì‹œì ì˜ ì›ë³¸ í…ìŠ¤íŠ¸ ë³´ì¡´ ë¹„ìœ¨, $ 1-\alpha_t $: masking token ë¹„ìœ¨, schedulerë¥¼ í†µí•´ ê²°ì •ë¨</p> <p>$ (\alpha_t &lt; \alpha_{t-1}) $</p> </li> <li> <p>$ \pi $: noise ë¶„í¬, MDLMì—ì„œëŠ” ê·¸ëƒ¥ mask í† í°ì„ noiseë¡œ ì‚¬ìš©í•˜ë¯€ë¡œ mask í† í°ì˜ ì¸ë±ìŠ¤ë§Œ 1ì¸ 1-hot vectorë¡œ ë³¼ ìˆ˜ ìˆìŒ [0,0,1]</p> </li> </ul> </li> <li> <p>ì„¤ëª…</p> <ol> <li> <table> <tbody> <tr> <td>$ q(\textbf{z}_t</td> <td>\textbf{x}) $: ì›ë³¸ í…ìŠ¤íŠ¸(x)ì—ì„œ t stepì˜ í›¼ì†ëœ í…ìŠ¤íŠ¸$ (\textbf{z}_t) $ê°€ ì‚°ì¶œë  í™•ë¥  [0.7, 0, 0.3]</td> </tr> </tbody> </table> </li> <li> <p>$ \alpha_t\textbf{x} $: ì›ë³¸ í…ìŠ¤íŠ¸ê°€ ë³´ì¡´ë  í™•ë¥ , [0.7, 0, 0]</p> </li> <li>$ (1-\alpha_t)\pi $: ë§ˆìŠ¤í¬ í† í°ìœ¼ë¡œ ì „í™˜ë  í™•ë¥  [0, 0, 0.3]</li> </ol> </li> </ul> <p>â‡’ ë§¤ ì‹œì ë§ˆë‹¤ ì ì°¨ ë§ì€ í† í°ë“¤ì´ mask í† í°ìœ¼ë¡œ ì „í™˜ë¨</p> <p><br></p> <h3 id="reverse-posterior-ë…¸ì´ì¦ˆë¥¼-ë³µì›-mask--actual-token">reverse posterior: ë…¸ì´ì¦ˆë¥¼ ë³µì›, mask â†’ actual token</h3> <p>reverse posterior</p> <p>$ q\left(\mathbf{z}<em>s \mid \mathbf{z}_t, \mathbf{x}\right)=\operatorname{Cat}\left(\mathbf{z}_s ;\frac{\left[\alpha</em>{t \mid s} \mathbf{z}<em>t+\left(1-\alpha</em>{t \mid s}\right) \mathbf{1} \boldsymbol{\pi}^{\top} \mathbf{z}_t\right] \odot\left[\alpha_s \mathbf{x}+\left(1-\alpha_s\right) \boldsymbol{\pi}\right]}{\alpha_t \mathbf{z}_t^{\top} \mathbf{x}+\left(1-\alpha_t\right) \mathbf{z}_t^{\top} \boldsymbol{\pi}}\right) $</p> <ul> <li> <p>t stepì—ì„œ ì´ì „ ì‹œì  $ s(&lt;t) $ê¹Œì§€ ë…¸ì´ì¦ˆë¥¼ ë³µì›í•˜ê¸° ìœ„í•œ ì¶”ì • í™•ë¥ </p> <ul> <li> <p>ì–´ë–¤ í† í°ì´ maskingë˜ì—ˆëŠ”ì§€ ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ í™•ë¥ ì ìœ¼ë¡œ ì¶”ì •í•´ì•¼ í•¨</p> </li> <li> <table> <tbody> <tr> <td>$ 0&lt;\alpha_{t</td> <td>s} = \frac{\alpha_t}{\alpha_s}&lt;1 $: s stepê³¼ t step ì‚¬ì´ì—ì„œ ë³´ì¡´ë˜ëŠ” ì›ë³¸ í† í° ë¹„ìœ¨</td> </tr> </tbody> </table> <ul> <li> <p>length: 100</p> </li> <li> <p>s(70) â†’ t(50)</p> </li> <li> <table> <tbody> <tr> <td>$ \textbf{a}_{t</td> <td>s} = \frac{0.5}{0.7}=\frac{5}{7} $</td> </tr> </tbody> </table> </li> </ul> </li> <li> <p>$ \alpha_{t \mid s} \mathbf{z}<em>t+\left(1-\alpha</em>{t \mid s}\right) \mathbf{1} \boldsymbol{\pi}^{\top}\textbf{z}^t $: s stepê³¼ t step ì‚¬ì´ì—ì„œ ë³´ì¡´ë˜ì—ˆë˜ ì›ë³¸ í† í° í™•ë¥ $ (\alpha_{t \mid s} \mathbf{z}_t) $ê³¼ maskingìœ¼ë¡œ ë³€í•´ë²„ë ¸ë˜ í† í°ì˜ í™•ë¥ $ (\mathbf{1} \boldsymbol{\pi}^{\top} \mathbf{z}_t) $</p> <ul> <li> <p>s stepì—ì„œ t stepìœ¼ë¡œ ì§„í–‰ë˜ë©´ì„œ maskingëœ í† í°ì„ ì¶”ì •í•˜ëŠ” í•­</p> </li> <li> <p>ì–´ë–¤ í† í°ì„ ë³µì›í• ì§€ ì •í•˜ëŠ” í•­</p> </li> <li> <p>[0.7, 0.7, 0.7] [1, 0, 0] + [0.3, 0.3, 0.3] [1,1,1][1,0,0]</p> <ul> <li>[0.7, 0, 0] + [0, 0., 0.3] = [0.7, 0, 0.3]</li> </ul> </li> </ul> </li> <li> <p>$ \alpha_s\textbf{x} + (1-\alpha_s) \boldsymbol{\pi} $: ì›ë³¸ í† í°$ (\textbf{x}) $ì˜ í™•ë¥ ê³¼ masking í† í°ìœ¼ë¡œ ì²˜ë¦¬ë  í™•ë¥ $ (\pi) $</p> <ul> <li>s stepì—ì„œëŠ” $ \alpha_s $ ë¹„ìœ¨ì˜ í† í°ë§Œ ì›ë³¸ í† í°ì´ì–´ì•¼ í•˜ê³ , $ (1-\alpha_s) $ ëŠ” ë§ˆìŠ¤í¬ í† í°ì´ì–´ì•¼ í•˜ë¯€ë¡œ 1) ì–´ë–¤ ìœ„ì¹˜ë¥¼ ì›ë³¸ í† í°ìœ¼ë¡œ ë‚¨ê¸¸ì§€ 2) í•´ë‹¹ ìœ„ì¹˜ì— ì–´ë–¤ í† í°ìœ¼ë¡œ ë³µì›í• ì§€ ì •í•˜ëŠ” í•­ì„</li> </ul> </li> </ul> </li> </ul> <p><br></p> <p>ğŸ’¡ ì‚¬ì‹¤ ì§€ê¸ˆê¹Œì§€ì˜ ìˆ˜ì‹ì€ masked diffusionì€ ì•„ë‹™ë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ì˜ ìˆ˜ì‹ì€ ì•„ë˜ì™€ ê°™ì€ íŠ¹ì„±ì„ ê°€ì •í•˜ê³  ì „ê°œë˜ì—ˆìŠµë‹ˆë‹¤.</p> <ol> <li>discreteí•œ time step</li> <li> <p>$ \pi $ì˜ noise distributionì´ ì¡´ì¬</p> <p>í•˜ì§€ë§Œ masked diffusionì€ ì´ë¥¼ ì¢€ ë” ë‹¨ìˆœí™”í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì™œëƒí•˜ë©´ $ \pi=m $ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p> <p>â‡’ ë…¸ì´ì¦ˆëŠ” ì„ì˜ì˜ ë¶„í¬ê°€ ì•„ë‹ˆë¼ ë¬´ì¡°ê±´ masking tokenì´ë‹¤! ê·¸ëŸ¬ë¯€ë¡œ ì´ì „ stepì—ì„œ maskingëœ í† í°ì€ ì´í›„ì—ë„ ë¬´ì¡°ê±´ maskingë˜ì–´ ì¡´ì¬í•˜ê²Œ ëœë‹¤!</p> </li> </ol> <p><br></p> <h2 id="masked-diffusion">Masked Diffusion</h2> <h3 id="forward-masking-process">forward masking process</h3> <p>$ q\left(\mathbf{z}_t \mid \mathbf{x}\right)=\operatorname{Cat}\left(\mathbf{z}_t ; \alpha_t \mathbf{x}+\left(1-\alpha_t\right) \boldsymbol{m}\right) $</p> <ul> <li>discrete diffusionì—ì„œ \piê°€ mìœ¼ë¡œ ë³€í•œ ê²ƒ ì™¸ì— ì°¨ì´ ì—†ìŠµë‹ˆë‹¤.</li> </ul> <p><br></p> <h3 id="reverse-posterior-ì‹¤ì œ-loss-ì‹ì„-ì‚°ì¶œí•˜ê¸°-ìœ„í•´-í•„ìš”í•œ-í•­">reverse posterior: ì‹¤ì œ loss ì‹ì„ ì‚°ì¶œí•˜ê¸° ìœ„í•´ í•„ìš”í•œ í•­</h3> <p>$ q\left(\mathbf{z}_s \mid \mathbf{z}_t, \mathbf{x}\right)= \begin{cases}\operatorname{Cat}\left(\mathbf{z}_s ; \mathbf{z}_t\right) &amp; \mathbf{z}_t \neq \mathbf{m} \ \operatorname{Cat}\left(\mathbf{z}_s ; \frac{\left(1-\alpha_s\right) \mathbf{m}+\left(\alpha_s-\alpha_t\right) \mathbf{x}}{1-\alpha_t}\right) &amp; \mathbf{z}_t=\mathbf{m}\end{cases} $</p> <ul> <li> <p>$ \textbf{z}_t \neq \textbf{m} $: step tì—ì„œ ì›ë³¸í† í°ì´ë¼ë©´ â†’ ê·¸ëŒ€ë¡œ ìœ ì§€</p> </li> <li> <p>$ \textbf{z} = \textbf{m} $: step tì—ì„œ masking tokenì´ë¼ë©´ â†’ step sì—ì„œ t ì‚¬ì´ì—ì„œ maskingë˜ì—ˆì„ í™•ë¥  ì‚°ì¶œ</p> <ul> <li>ê·¼ë° ì‹¤ì œ í…ìŠ¤íŠ¸($ \textbf{x} $)ë¥¼ ì•Œì•„ì•¼ ì‚°ì¶œí•  ìˆ˜ ìˆëŠ” í•­</li> </ul> <p>â‡’ ë³µì› ë‹¨ê³„ì—ì„œëŠ” ì•Œ ìˆ˜ ì—†ìœ¼ë‹ˆ MDLMì´ ë“±ì¥</p> <p>â‡’ $ \textbf{x}_\theta(\textbf{z}_t, t): \theta $ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ê°€ì§€ëŠ” ëª¨ë¸ì— ì˜í•´ $ t $ stepì—ì„œ ë³µì›ëœ ë¬¸ì¥</p> <p>### MDLMì˜ ìƒí™©ì— ë§ì¶˜ 2ê°€ì§€ property</p> </li> </ul> <ol> <li> <p>Zero Masking Probabilities: $ &lt;\textbf{x}, \textbf{m}&gt;=0 $ì„. ì¦‰, ì›ë³¸ í† í° ì¤‘ì—ëŠ” masking tokenì´ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ</p> <p>â‡’ ëª¨ë¸ì„ í†µí•´ ë³µì›í•  ë•Œ, mask tokenì— ëŒ€í•œ logitì€$ -\infin $ë¡œ ì²˜ë¦¬</p> </li> <li> <p>Carry-Over Unmasking: step tì—ì„œ ë³µì›(unmasking)ëœ í† í°ì€ ì´í›„ ëª¨ë¸ì˜ ë³µì› ê³¼ì •ì—ì„œ ìˆ˜ì •ë˜ì§€ ì•ŠìŒ</p> <ol> <li>t=4ì—ì„œ â€œaâ€ë¼ê³  ë³µì›ë˜ì—ˆë‹¤ë©´, t=1ì—ì„œ â€œbâ€ë¡œ ë°”ë€Œì§€ ì•Šê³  ë¬´ì¡°ê±´ â€œaâ€ë¡œ ê³ ì •</li> </ol> </li> </ol> <p><br></p> <h3 id="rao-balckwellized-likelihood-bounds">Rao-Balckwellized Likelihood Bounds</h3> <p>diffusion lossë¥¼ ì‚°ì¶œí•˜ë“¯ì´ ë³¸ë˜ í•™ìŠµí•  discrete-time diffusionì˜ lossì˜ lower boundë¥¼ ì‚°ì¶œí•˜ë©´ ì•„ë˜ì™€ ê°™ìŒ</p> <p><br></p> <h3 id="continuous-time-likelihood-bounds">Continuous-Time Likelihood Bounds</h3> <p>ê¸°ì¡´ ì—°êµ¬ì—ì„œ ì •ë¦¬í•˜ê¸°ë¡œ $ T \to \infin $ë¡œ ì •ì˜í•  ê²½ìš° ë”ìš± tightí•œ lower boundë¥¼ ì‚°ì¶œí•  ìˆ˜ ìˆìŒ</p> <p><br></p> <h3 id="masked-diffusion-language-models">Masked Diffusion Language Models</h3> <p>ì•ì—ì„œ ì •ì˜ëœ tightí•œ lower boundë¥¼ language modeling ìƒí™©ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ì•„ë˜ ê°€ì •ë“¤ì„ ì ìš©í•  ìˆ˜ ìˆìŒ</p> <ol> <li> <p>$ \textbf{x}^{1:L} $: Lê°œì˜ token sequence</p> </li> <li> <p>$ \textbf{x}^\textit{l} $: $ \textit{l} $ë²ˆì§¸ í† í°</p> </li> <li> <p>forwardì™€ backward ëª¨ë‘ ê° í† í°ë“¤ì´ ë…ë¦½ì ìœ¼ë¡œ ì§„í–‰</p> </li> </ol> <ul> <li> <p>$ \textbf{x}^\textit{l}_\theta(\textbf{z}_t^{1:L}, t) $: të²ˆì§¸ stepì—ì„œì˜ ì‹œí€€ìŠ¤ì— ëŒ€í•œ ëª¨ë¸ì˜ ì˜ˆì¸¡ ë¬¸ì¥, maskingëœ í† í°ì„ ì˜ˆì¸¡í•˜ì—¬ ë³µì›í•œ ë¬¸ì¥ë¬¸</p> </li> <li> <p>$ \log&lt;\textbf{x}^\textit{l}_\theta(\textbf{z}_t^{1:L}, t), \textbf{x}^\textit{l}&gt; $: loglikelihood, ê°‘ìê¸°ìš”â€¦?!</p> </li> <li> <p>ì´ë•Œ $ \alpha_s $ ê°€ ì‚¬ë¼ì§„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ</p> <ul> <li> <p>maskingê³¼ unmasking ì‹œ schedulerì˜ í•„ìš”ì„± X â†’ ë§ì€ ì—°ì‚°ì„ ìƒëµí•  ìˆ˜ ìˆìŒ, ì¶”ë¡  ì‹œ ì´ì  ì¡´ì¬</p> </li> <li> <p>ì‹¤ì œ masking ë¹„ìœ¨ì— ë”°ë¼ ë‹¤ë¥¸ loss ë°˜ì˜</p> <ul> <li> <p>ë§ì€ í† í°ì´ maskingëœ ê²½ìš°($ \alpha_t $ê°€ ì‘ì€ ê²½ìš°): weightê°€ ì‘ì•„ì§ â‡’ ëª¨ë¸ì´ ë¶ˆí™•ì‹¤í•  ìˆ˜ ë°–ì— ì—†ëŠ” ìƒí™©ì—ì„œ í•™ìŠµì„ ì ê²Œ ë°˜ì˜</p> </li> <li> <p>ì ì€ í† í°ì´ maskingëœ ê²½ìš°($ \alpha_t $ê°€ í° ê²½ìš°): weightê°€ ì»¤ì§ â‡’ ëª¨ë¸ì´ í™•ì‹¤íˆ ë§ì¶”ì–´ì•¼ í•˜ëŠ” ë°ì´í„°ì— ëŒ€í•´ í•™ìŠµì„ ë§ì´ ë°˜ì˜</p> </li> </ul> </li> </ul> <p><br></p> </li> </ul> <p>ğŸ’¡ MDLMì€ ê²°êµ­ discrete-time diffusion modelì„ maskingê³¼ text domainì— ì í•©í•œ ê°€ì •ì„ ë„ì…í•œ ê²°ê³¼ weighted sum of MLMì´ë¼ëŠ” ê²°ë¡ ì— ë„ë‹¬</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BERTì˜ ëª©ì í•¨ìˆ˜ë¥¼ ì¼ë¶€ ë³€í˜•í•˜ëŠ” ê²ƒìœ¼ë¡œ ë„ì…ì´ ê°€ëŠ¥í•´ì§!
</code></pre></div></div> <p><br></p> <h3 id="training-algorithm">Training Algorithm</h3> <ol> <li> <p>ë°ì´í„° sampling</p> </li> <li> <p>step sampling</p> </li> <li> <p>ì´ì „ step ëŒ€ë¹„ ì¶”ê°€ì ìœ¼ë¡œ $ \alpha_t $ ë¹„ìœ¨ì„ maskingí•œ masked input ì‚°ì¶œ</p> </li> <li> <p>weighted sum of MLM loss í˜•ì‹ìœ¼ë¡œ update</p> </li> </ol> <p><br></p> <h2 id="actual-inference">Actual Inference</h2> <p>í•´ë‹¹ ìˆ˜ì‹ì„ í†µí•´ ì‹¤ì œ ìƒì„±ì´ ì´ë£¨ì–´ì§€ê²Œ ë¨</p> <ol> <li> <p>$ \textbf{z}_t = \textbf{m}: $ t stepì—ì„œ mask í† í°ìœ¼ë¡œ ì…ë ¥ëœ ìœ„ì¹˜ì— ëŒ€í•´ì„œë§Œ ì˜ˆì¸¡ ìˆ˜í–‰</p> </li> <li> <p>$ \frac{(1-\alpha_s)\textbf{m} + (\alpha_s - \alpha_t)\textbf{x}<em>\theta(\textbf{z}_t, t)}{1-\alpha_t} = \frac{1-\alpha_s}{1-\alpha_t}\textbf{m} + \frac{\alpha_s-\alpha_t}{1-\alpha_t}\textbf{x}</em>\theta(\textbf{z}_t, t) $: ëª¨ë“  mask í† í° ìœ„ì¹˜ì—ì„œ ì˜ˆì¸¡ëœ í™•ë¥ ë¶„í¬ ì¤‘ì—ì„œ$ \frac{1-\alpha_s}{1-\alpha_t} $ë¹„ìœ¨ì€ ë‹¤ì‹œ maskingìœ¼ë¡œ ëŒë¦¼</p> </li> </ol> <p>â‡’ ë§¤ iteration ë§ˆë‹¤$ \frac{\alpha_s - \alpha_t}{1-\alpha_t} $ë§Œí¼ì˜ í† í°ì´ ë³µì›ë˜ë©´ì„œ ìƒì„±</p> <p><br></p> <h3 id="1-perplexity-evaluation">1. Perplexity evaluation</h3> <ul> <li> <p>ë™ì¼í•œ corpusë¥¼ ì´ìš©í•˜ì—¬ autoregressive modelê³¼ MDLMì„ í•™ìŠµì‹œì¼œ ë¹„êµ</p> <p>â‡’ ì‹¤ì œ ì…ë ¥ë˜ëŠ” non-masked token ìˆ˜ì˜ ì°¨ì´ë¥¼ ì—†ì• ê¸° ìœ„í•œ ë‹¤ë¥¸ update step ì‚¬ìš©</p> <ul> <li> <p>autoregressive model: 0.5M step</p> </li> <li> <p>MDLM: 1M step</p> </li> </ul> </li> </ul> <p><br></p> <h3 id="2-training-nll">2. Training NLL</h3> <ul> <li> <p>ê¸°ì¡´ DDLM(SEDD)ë³´ë‹¤ í›¨ì”¬ ì•ˆì •ì ì¸ NLLì„ ë³´ì´ë©° í•™ìŠµ</p> <p>â‡’ 2ê°€ì§€ propertyë¥¼ ì´ìš©í•˜ì—¬ tightí•œ lower boundë¥¼ í˜•ì„±í•œ ë•ë¶„</p> </li> </ul> <p><br></p> <h3 id="3-zero-shot-perplexity">3. Zero-shot Perplexity</h3> <ul> <li> <p>ë‹¤ì–‘í•œ ë¶„ì•¼ì— ëŒ€í•˜ì—¬ ARê³¼ ê·¼ì ‘í•œ ìˆ˜ì¤€ì˜ ì„±ëŠ¥ ë‹¬ì„±</p> <ul> <li>PubMed, Arxivì™€ ê°™ì€ íŠ¹ìˆ˜ ë„ë©”ì¸ì˜ ê²½ìš°ì—ëŠ” DDLMì´ ARë³´ë‹¤ ë‚˜ì€ ëª¨ìŠµì„ ë³´ì„ â†’ Unmasking í•™ìŠµ ë°©ì‹ ìì²´ê°€ OODì— robustí•  ìˆ˜ ìˆìŒ</li> </ul> </li> </ul> <p><br></p> <h3 id="4-downstream-task">4. Downstream Task</h3> <ul> <li> <p>BERTë¥¼ MDLMìœ¼ë¡œ ì¼ë¶€ finetuneí•œ ê²°ê³¼ë¡œ ë¹„êµ</p> <ul> <li> <p>5k step finetune ì§„í–‰</p> </li> <li> <p>ì‚¬ì‹¤ í° ì˜ë¯¸ëŠ” ëª¨ë¥´ê² ìŒâ€¦</p> </li> </ul> </li> </ul> <p><br></p> <ul> <li> <p>ìˆ˜ì‹ ì „ê°œë¥¼ í†µí•´ì„œ weighted sum of MLM í˜•ì‹ì˜ diffusion model formulation</p> </li> <li> <p>ê¸°ì¡´ diffuion lmë“¤ë³´ë‹¤ ì¢‹ì€ ì„±ëŠ¥ê³¼ ì•ˆì •ëœ í•™ìŠµì„ ë³´ì„</p> <ul> <li>(ì—¬ê¸°ì„œ ë‹¤ë£¨ì§€ëŠ” ì•Šì•˜ì§€ë§Œ) ê°„ë‹¨í•œ ì¶”ë¡  caching ë° ìƒì„± ë°©ë²•ë¡ ë„ í•¨ê»˜ ì œì‹œí•˜ì—¬ í›„ì† ì—°êµ¬ë¡œ ì´ì–´ì§</li> </ul> </li> <li> <p>í•´ë‹¹ ë…¼ë¬¸ì˜ í”„ë ˆì„ì›Œí¬ê°€ ì´í›„ LLaDA ë“±ì—ì„œ í™œìš© â‡’ ì•„ë§ˆ í–¥í›„ MDLMì˜ í‘œì¤€ì´ ë˜ì§€ ì•Šì„ê¹Œâ€¦?</p> </li> </ul> <p><br></p> <p><br></p> <p><br></p> </div> </article> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <br> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'unknown-nlp/unknown-nlp.github.io',
        'data-repo-id': '',
        'data-category': 'Comments',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2025 You R. Name. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/al-folio/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/al-folio/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/al-folio/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/al-folio/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/al-folio/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/al-folio/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/al-folio/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/al-folio/assets/js/search-data.js"></script> <script src="/al-folio/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>