<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> In-Context Retrieval-Augmented Language Models | You R. Name </title> <meta name="author" content="You R. Name"> <meta name="description" content=" ë…¼ë¬¸ ë¦¬ë·° - In-Context Retrieval-Augmented Language Models"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/al-folio/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/al-folio/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/al-folio/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/al-folio/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://alshedivat.github.io/al-folio/blog/2024/in-context-retrieval-augmented-language-models/"> <script src="/al-folio/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/al-folio/"> <span class="font-weight-bold">You</span> R. Name </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/al-folio/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/al-folio/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/people/">people </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/al-folio/books/">bookshelf</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/al-folio/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">In-Context Retrieval-Augmented Language Models</h1> <p class="post-meta"> Created on July 30, 2024 </p> <p class="post-tags"> <a href="/al-folio/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a> Â  Â· Â  <a href="/al-folio/blog/tag/llm"> <i class="fa-solid fa-hashtag fa-sm"></i> llm</a> Â  <a href="/al-folio/blog/tag/paper-review"> <i class="fa-solid fa-hashtag fa-sm"></i> paper-review</a> Â  Â· Â  <a href="/al-folio/blog/category/paper-reviews"> <i class="fa-solid fa-tag fa-sm"></i> paper-reviews</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p><strong>ë…¼ë¬¸ ì •ë³´</strong></p> <ul> <li> <strong>Date</strong>: 2024-07-30</li> <li> <strong>Reviewer</strong>: ê¹€ì¬í¬</li> <li> <strong>Property</strong>: Retrieval, ICL, In Context Learning</li> </ul> <hr> <hr> <h2 id="1-1-contributions">1-1. Contributions</h2> <p>2023ë…„ 01ì›”ì— ë°œí‘œëœ ë…¼ë¬¸ì´ë¼ëŠ” ì ì„ ê°ì•ˆ</p> <p>ğŸ’¡ 1. Off-the-shelf Retrieverì„ ì´ìš©í•œ RAG í”„ë ˆì„ì›Œí¬ ìœ íš¨ì„± ì…ì¦</p> <ol> <li>RAG í”„ë ˆì„ì›Œí¬ ë‚´ ì„¤ê³„ ìš”ì†Œ(retriever, stride, reranker)ì— ëŒ€í•œ ì‹¤í—˜ ì§„í–‰</li> </ol> <ul> <li> <p>ì „ë°˜ì ì¸ ë…¼ë¬¸ì˜ ì„œìˆ ì€ ìµœê·¼ í™œë°œíˆ ì‚¬ìš©ë˜ëŠ” RAG í”„ë ˆì„ì›Œí¬ì—ì„œ í¬ê²Œ ë‹¤ë¥´ì§€ ì•ŠìŒ</p> <ul> <li>ë‹¹ì—°í•œ ë‚´ìš©ì„ ë‹¹ì—°í•  ìˆ˜ ìˆë„ë¡ ì •ë¦¬í•œ ë…¼ë¬¸!</li> </ul> </li> </ul> <p><br></p> <h2 id="1-2-tldr">1-2. TL;DR</h2> <ol> <li> <p>Off-the-shelf Retriever ì—­ì‹œ Reader ì„±ëŠ¥ í–¥ìƒì— ë„ì›€ì„ ì¤€ë‹¤.</p> </li> <li> <p>Retrieverì˜ ì¢…ë¥˜(sparse, dense)ì™€ ê´€ê³„ì—†ì´ ì„±ëŠ¥ í–¥ìƒì— ë„ì›€ì„ ì¤€ë‹¤.</p> </li> <li> <p>strideëŠ” ì ì ˆíˆ ì§§ê²Œ, retrieved passageì˜ ìˆ˜ëŠ” ë§ì„ìˆ˜ë¡ ì„±ëŠ¥ í–¥ìƒì— ë„ì›€ì´ ëœë‹¤.</p> <ol> <li>í•˜ì§€ë§Œ strideê°€ ì§§ì„ìˆ˜ë¡, retrieved passageê°€ ë§ì„ìˆ˜ë¡ ì—°ì‚°ëŸ‰ ì¦ê°€</li> </ol> </li> <li> <p>RerankerëŠ” ë‹¹ì—°í•˜ê²Œë„ ë„ì›€ì´ ëœë‹¤.</p> </li> </ol> <p><br></p> <blockquote> <p>RALMì˜ Design ChoiceëŠ” ì´ˆë¡ìƒ‰ ê¸€ì”¨ë¡œ í‘œì‹œí•˜ì˜€ìŠµë‹ˆë‹¤.</p> </blockquote> <h2 id="2-1-retriever-augmented-generationrag"><a href="https://arxiv.org/abs/2005.11401" rel="external nofollow noopener" target="_blank">2-1. Retriever-Augmented Generation(RAG)</a></h2> <ul> <li> <p>Knowledge Intensive Task ì‹œ ì™¸ë¶€ Documentë¥¼ ì ì ˆíˆ ì´ìš©í•˜ë„ë¡ Retrieverë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•ë¡  ì œì•ˆ</p> </li> <li> <p>Retriever(query encoder)ì™€ Generator(T5)ë¥¼ ë™ì‹œì— í›ˆë ¨í•˜ëŠ” í•™ìŠµ ë°©ë²•ë¡  ì œì•ˆ</p> </li> </ul> <h3 id="2-1-1-í•™ìŠµ-ë°©ë²•">2-1-1. í•™ìŠµ ë°©ë²•</h3> <ol> <li> <p>Retriever í›ˆë ¨: Knowledge Intensive Dataset(NQ, TriviaQA)ìœ¼ë¡œ í›ˆë ¨ëœ DPR ëª¨ë¸ ì´ìš©</p> </li> <li> <p>End-to-End í›ˆë ¨: (Retrieveëœ document kê°œ, relevance score kê°œ, Generation Prob)ì„ ì´ìš©í•˜ì—¬ Generatorì™€ Retriever í›ˆë ¨</p> </li> </ol> <h3 id="2-1-2-ì„±ëŠ¥">2-1-2. ì„±ëŠ¥</h3> <ul> <li>ë‹¤ì–‘í•œ Knowledge Intensive Taskì—ì„œ ê¸°ì¡´ ë°©ë²•ë¡  ëŒ€ë¹„ ë†’ì€ ì„±ëŠ¥ ë‹¬ì„±</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[//]: # (column is not supported)

	- ê¸°ì¡´ ë°©ë²•ë¡ :

		- Closed Book: ì™¸ë¶€ Documentë¥¼ ì´ìš© X

		- Open Book: ì™¸ë¶€ documentë¥¼ ì´ìš©í•˜ë˜, Encoder-only Reader ì‚¬ìš©

[//]: # (column is not supported)

	## 2-2. **[Improving language models by retrieving from trillions of tokens(RETRO)](https://arxiv.org/abs/2112.04426)**
</code></pre></div></div> <ul> <li> <p>RAGë¥¼ í™•ì¥í•˜ì—¬ ë‹¤ì–‘í•œ ì¼ë°˜ íƒœìŠ¤í¬ì— ì ìš©í•  ìˆ˜ ìˆëŠ” í”„ë ˆì„ì›Œí¬ ì œì•ˆ</p> </li> <li> <p>Retriever(BERT)ë¥¼ Freezeí•˜ê³  queryì™€ ê°€ì¥ ê°€ê¹Œìš´ ë¬¸ì„œì˜ representationì— ëŒ€í•œ attention(Chunked Cross-Attention)êµ¬ì¡° ì œì•ˆ</p> </li> </ul> <h3 id="2-2-1-ì„±ëŠ¥">2-2-1. ì„±ëŠ¥</h3> <ul> <li> <p>ëª¨ë¸ í¬ê¸°(million to billion)ì— ê´€ê³„ì—†ì´ ì¼ê´€ëœ ì„±ëŠ¥ ê°œì„  ê´€ì°°</p> </li> <li> <p>Retriever ì‚¬ìš© ì—¬ë¶€(on/off)ê°€ ì„±ëŠ¥ ê°œì„ ì— í° ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ê²ƒ í™•ì¸</p> </li> </ul> <p><br></p> <h2 id="2-3-ìš”ì•½">2-3. ìš”ì•½</h2> <p><strong>2023ë…„ì˜ ìƒí™©</strong></p> <ul> <li> <p>LLaMAì˜ ë“±ì¥ ì´í›„ Open Source LLMì— ëŒ€í•œ ì—°êµ¬ ì§„í–‰</p> <ul> <li> <p>Zero/Few-shot ì„±ëŠ¥ì„ ê°œì„ ì‹œí‚¤ê¸° ìœ„í•œ ë‹¤ì–‘í•œ ë°©ë²•ë¡  ì œì•ˆ</p> </li> <li> <p>CoT, In-Context Learning</p> </li> </ul> </li> <li> <p>Million Scaleì˜ RAG í”„ë ˆì„ì›Œí¬ ì—°êµ¬ë“¤ì´ ëë¬¼ì„ í–¥í•´ ê°€ê³  ìˆìŒ</p> <ul> <li> <a href="https://arxiv.org/abs/2007.01282" rel="external nofollow noopener" target="_blank">FiD</a>, <a href="https://arxiv.org/abs/2208.03299" rel="external nofollow noopener" target="_blank">Atlas</a>, <a href="https://arxiv.org/abs/2209.14290" rel="external nofollow noopener" target="_blank">FiD-Light </a> </li> </ul> </li> <li> <p>LLMì— RAG í”„ë ˆì„ì›Œí¬ ì ìš©ì´ í™œë°œíˆ ì‹œì‘ë˜ë˜ ì‹œê¸°</p> </li> </ul> <h2 id="3-1-in-context-ralmretriever-augmented-language-modeling">3-1. In-Context RALM(Retriever-Augmented Language Modeling)</h2> <h3 id="3-1-1-language-modeling">3-1-1. Language Modeling</h3> \[p\left(x_1, \ldots, x_n\right)=\prod_{i=1}^n p_\theta\left(x_i \mid x_{&lt;i}\right)\] <ul> <li>Prefix($ x_{&lt;i} $)ë¥¼ ë°”íƒ•ìœ¼ë¡œ í˜„ì¬ ì‹œì (i)ì˜ í† í° ë¶„í¬ë¥¼ ìƒì„±í•˜ëŠ” ì‘ì—…</li> </ul> <h3 id="3-1-2-naive-in-context-ralm">3-1-2. Naive In-Context RALM</h3> \[p\left(x_1, \ldots, x_n\right)= \quad \prod_{i=1}^n p_\theta\left(x_i \mid\left[\mathcal{R}_{\mathcal{C}}\left(x_{&lt;i}\right) ; x_{&lt;i}\right]\right)\] <ul> <li> <p>ê¸°ì¡´ LMì— Retriever ì¶”ê°€</p> </li> <li> <p>$ \mathcal{R}<em>{\mathcal{C}}(x</em>{&lt;i}) $: Prefixë¥¼ queryë¡œ Retriever ìˆ˜í–‰í•œ Top-k document</p> </li> <li> <p>ë§¤ ì‹œì ë§ˆë‹¤ ë‹¤ìŒ ê³¼ì • ìˆ˜í–‰</p> <ol> <li> <p>Retrieval: í˜„ì¬ ì‹œì ê¹Œì§€ì˜ prefixë¥¼ queryë¡œ document retrieval</p> </li> <li> <p>Concatenation: ê¸°ì¡´ í…ìŠ¤íŠ¸($ x_{&lt;i} $)ì™€ Retrieved Documentë¥¼ concat</p> <ol> <li> <span style="color:green">concatëœ í…ìŠ¤íŠ¸ê°€ modelì˜ max lengthë¥¼ ë„˜ì„ ê²½ìš° ê¸°ì¡´ í…ìŠ¤íŠ¸(</span>$ x_{&lt;i} $<span style="color:green">)ë¥¼ truncation</span> </li> </ol> </li> <li> <p>Generation: ê¸°ì¡´ì— ìƒì„±ëœ í…ìŠ¤íŠ¸($ x_{&lt;i} $)ì™€ Retrieved Documentë¥¼ ëª¨ë‘ ì…ë ¥ìœ¼ë¡œ í•˜ì—¬ i ì‹œì ì˜ token dist. ìƒì„±</p> </li> </ol> </li> </ul> <p><br></p> <h2 id="3-2-ralm-design-choices">3-2. RALM Design Choices</h2> <h3 id="3-2-1-retrieval-stride-s-">3-2-1. Retrieval Stride($ s $)</h3> \[p\left(x_1, \ldots, x_n\right)= \quad \prod_{j=0}^{n_s-1} \prod_{i=1}^s p_\theta\left(x_{s \cdot j+i} \mid\left[\mathcal{R}_{\mathcal{C}}\left(x_{\leq s \cdot j}\right) ; x_{&lt;(s \cdot j+i)}\right]\right)\] <p>ğŸ’¡ <span style="color:orange">ì˜¤ëŠ˜ ì„œìš¸ì—ì„œ </span><span style="color:green">ëŒ€ì „ê¹Œì§€ ê°€ëŠ” ë™ì•ˆ</span> <span style="color:blue">ë‚ ì”¨ê°€ ì–´ë–»ê²Œ</span> <span style="color:pink">ë³€í•  ê²ƒ ê°™ì•„? </span><span style="color:orange">ê¸ˆì¼ ì„œìš¸ì˜ ë‚ ì”¨ëŠ” 28ë„ë¡œ ì˜¨í™” â€¦ </span><span style="color:green">ê¸ˆì¼ ëŒ€ì „ì˜ ë‚ ì”¨ëŠ” 35ë„ë¡œ ë§¤ìš° ë”ìš¸ ì˜ˆì • â€¦ </span><span style="color:blue">ì „êµ­ ë‚ ì”¨ëŠ” ë¹„ê°€ ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤. </span></p> <ul> <li> <p>Naive RALM: ë§¤ í† í°ë§ˆë‹¤ Retrieval ì§„í–‰</p> <ul> <li>Retrieval ë¹„ìš© + ìƒˆë¡­ê²Œ representation ê³„ì‚° ë¹„ìš© ë°œìƒ â†’ High cost</li> </ul> </li> <li> <p>Retrieval Stride($ s $): retrievalì„ ìˆ˜í–‰í•  ê°„ê²©</p> <ul> <li>$ s=3 $: 3í† í° ìƒì„± ì‹œë§ˆë‹¤ ìƒˆë¡­ê²Œ retrievalì„ ìˆ˜í–‰</li> </ul> </li> <li> <p>$ n_s(=n/s) $: ì „ì²´ text lengthê°€ $ n $ì¼ ë•Œ, retrieval íšŸìˆ˜</p> </li> <li> <p>$ s $ì˜ í¬ê¸°ëŠ” ì†ë„(ì—°ì‚°ëŸ‰)ê³¼ ì„±ëŠ¥ ê°„ trade-off ê´€ê³„</p> <ul> <li>$ s $ê°€ ì»¤ì§ˆìˆ˜ë¡ ì†ë„ëŠ” ë¹¨ë¼ì§€ì§€ë§Œ, ì„±ëŠ¥ì€ ì €í•˜ë¨</li> </ul> </li> </ul> <p><br></p> <h3 id="3-2-2-retrieval-query-length-ell-">3-2-2. Retrieval Query Length($ \ell $)</h3> \[p\left(x_1, \ldots, x_n\right)= \prod_{j=0}^{n_s-1} \prod_{i=1}^s p_\theta\left(x_{s \cdot j+i} \mid\left[\mathcal{R}_{\mathcal{C}}\left(q_j^{s, \ell}\right) ; x_{&lt;(s \cdot j+i)}\right]\right)\] <p>ğŸ’¡ <span style="color:orange">ì˜¤ëŠ˜ ì„œìš¸ì—ì„œ </span><span style="color:green">ëŒ€ì „ê¹Œì§€ ê°€ëŠ” ë™ì•ˆ</span> â€¦<span style="color:orange"> </span>$ \mathcal{R}<em>{\mathcal{C}} $<span style="color:orange">(ì˜¤ëŠ˜ ì„œìš¸ì—ì„œ ëŒ€ì „ê¹Œì§€ ê°€ëŠ” ë™ì•ˆ)</span> â†’ ì„œìš¸? ëŒ€ì „? $ \mathcal{R}</em>{\mathcal{C}} $<span style="color:green">(ëŒ€ì „ê¹Œì§€ ê°€ëŠ” ë™ì•ˆ)</span> â†’ ëŒ€ì „ì˜ ë‚ ì”¨!</p> <ul> <li> <p>Naive RALM: í˜„ì¬ê¹Œì§€ ìƒì„±ëœ ëª¨ë“  textë¥¼ queryë¡œ ì‚¬ìš©</p> <ul> <li>í˜„ì¬ ì‹œì  token dist. ìƒì„± ì‹œ ì¤‘ìš”í•œ ì •ë³´ê°€ í¬ì„ë  ìˆ˜ ìˆìŒ</li> </ul> </li> <li> <p>$ q_j^{s, \ell}:=x_{s \cdot j-\ell+1}, \ldots, x_{s \cdot j} $: í˜„ì¬ê¹Œì§€ ìƒì„±ëœ í† í° ì¤‘ ì§ì „ $ \ell $ ê¸¸ì´ì˜ í† í°ë§Œ queryë¡œ í™œìš©</p> </li> </ul> <p><br></p> <h2 id="3-3-reranking">3-3. Reranking</h2> <h3 id="3-3-1-lm-as-zero-shot-rerankers">3-3-1. LM as Zero-Shot Rerankers</h3> <ul> <li> <p>LMì„ í•™ìŠµì—†ì´ Rerankerë¡œ í™œìš©í•˜ëŠ” ë°©ë²•ë¡  ì œì‹œ</p> </li> <li> <p>k: Top-kê°œì˜ Retrieved Document</p> </li> <li> <p>Objective: kê°œì˜ Document ì¤‘ ì„±ëŠ¥ ê°œì„ ì— ë„ì›€ì„ ì¤„ ìˆ˜ ìˆëŠ” top-1 docì„ rerank</p> <p>â‡’ train dataê°€ ì—†ëŠ” í™˜ê²½ì—ì„œ í•´ë‹¹ ì •ë³´ê°€ ë°˜ì˜ëœ Reranker êµ¬ì¶• X</p> \[i^*=\arg \max _{i \in[k]} p_\theta\left(y \mid\left[d_i ; x_{\leq s \cdot j}\right]\right) .\] </li> <li> <p>ì…ë ¥ëœ textì˜ ì¼ë¶€ë¥¼ validation dataë¡œ í™œìš©</p> </li> </ul> \[\hat{i}=\arg \max _{i \in[k]} p_\phi\left(y^{\prime} \mid\left[d_i ; x_{\leq\left(s \cdot j-s^{\prime}\right)}\right]\right) .\] <ul> <li> <p>reranking: ì…ë ¥ í…ìŠ¤íŠ¸ì˜ ë§ˆì§€ë§‰ $ sâ€™ $ê°œ í† í° PPLì„ ìµœì†Œí™”í•˜ëŠ” document íƒìƒ‰ ì‘ì—…</p> <ul> <li>LMì„ ì´ìš©í•˜ì—¬ zero-shot reranker êµ¬ì¶• ê°€ëŠ¥</li> </ul> </li> </ul> <p><br></p> <h3 id="3-3-2-training-lm-dedicated-rerankers">3-3-2. Training LM-dedicated Rerankers</h3> <ul> <li> <p>RoBERTaë¥¼ í›ˆë ¨í•˜ì—¬ Rerankerë¡œ í™œìš©í•˜ëŠ” ë°©ì•ˆ ì œì‹œ</p> <ul> <li>Language Modeling ìƒí™©ì—ì„œ í™œìš© ê°€ëŠ¥í•œ reranker í›ˆë ¨ ë°©ë²•ë¡ </li> </ul> </li> <li> <p>Relevance Score: Rerankerì˜ scoreë¥¼ normalizeí•˜ì—¬ ì‚¬ìš©</p> \[p_{\text {rank }}\left(d_i \mid x_{\leq s \cdot j}\right)=\frac{\exp \left(f\left(x_{\leq s \cdot j}, d_i\right)\right)}{\sum_{i^{\prime}=1}^k \exp \left(f\left(x_{\leq s \cdot j}, d_{i^{\prime}}\right)\right)} \\ \hat{i}=\arg \max _{i \in[k]} p_{\text {rank }}\left(d_i \mid x_{\leq s \cdot j}\right) .\] </li> <li> <p>Training Objectives: PPLì„ ë‚®ì¶”ëŠ” Documentì˜ Relevance Scoreë¥¼ ë†’ì´ë„ë¡ í•™ìŠµ</p> </li> </ul> \[-\log \sum_{i=1}^k p_{\text {rank }}\left(d_i \mid x_{\leq s \cdot j}\right) \cdot p_\theta\left(y \mid\left[d_i ; x_{\leq s \cdot j}\right]\right)\] <h2 id="4-1-experiment-setup">4-1. Experiment Setup</h2> <h3 id="4-1-1-datasets">4-1-1. Datasets</h3> <ol> <li> <p><strong>Language Modeling(Perplexity)</strong></p> <ol> <li> <p>WikiText-103: ì¼ë°˜ì ì¸ LM ì„±ëŠ¥ í‰ê°€ìš© corpus</p> </li> <li> <p>The Pile(ArXiv, Stack Exchange, FreeLaw): íŠ¹ì • ë„ë©”ì¸(ê³¼í•™, ì½”ë“œ, ë²•ë¥ )ì— ëŒ€í•œ LM ì„±ëŠ¥ í‰ê°€ ëª©ì </p> </li> <li> <p>RealNews: ì¼ë°˜ì ì¸ RALM í”„ë ˆì„ì›Œí¬ ì‚¬ìš© í™˜ê²½(Knowledge-Intensive task)ì— ëŒ€í•œ ì„±ëŠ¥ í‰ê°€ ëª©ì </p> </li> </ol> </li> <li> <p><strong>Open-Domain Question Answering(Exact Match)</strong></p> <ol> <li> <p>RALMì˜ ì‹¤ì œ ì •ë‹µ ìƒì„± ëŠ¥ë ¥ í‰ê°€ ëª©ì </p> </li> <li> <p>ì§€ì‹ ê¸°ë°˜ì˜ ì§ˆì˜ì‘ë‹µ ë°ì´í„°ì…‹ ì´ìš©</p> </li> <li> <p>Natural Questions, TriviaQA</p> </li> </ol> </li> </ol> <p><br></p> <h3 id="4-1-2-models">4-1-2. Models</h3> <ol> <li> <p><strong>Language Models</strong></p> <ol> <li> <p>GPT-2(110M ~ 1.5B): Wikipedia ë¬¸ì„œê°€ ì œì™¸ë˜ì–´ í•™ìŠµ</p> <p>â‡’ WikiText-103ì„ ì´ìš©í•˜ì—¬ ì™„ì „í•œ zero-shot ìƒí™©ì—ì„œì˜ ì„±ëŠ¥ í™•ì¸ ê°€ëŠ¥</p> </li> <li> <p>GPT-Neo, GPT-J(1.2B ~ 6B)</p> </li> <li> <p>OPT(125M ~ 66B)</p> </li> <li> <p>LLaMA1(7B ~ 33B)</p> <ol> <li> <p>ë‹¤ì–‘í•œ scaleì˜ ëª¨ë¸ì— ëŒ€í•œ íš¨ê³¼ ê²€ì¦</p> </li> <li> <p>Wikipediaê°€ í•™ìŠµì— ì´ìš©ë˜ì—ˆìœ¼ë¯€ë¡œ í•™ìŠµë°ì´í„°ì˜ RALM íš¨ê³¼ í™•ì¸</p> </li> </ol> </li> </ol> <p><span style="color:green"><strong>Context Length: 1024</strong></span></p> </li> <li> <p><strong>Retriever</strong></p> <ol> <li> <p>Sparse Retriever: BM25</p> </li> <li> <p>Dense Retriever</p> <ol> <li> <p>BERT: RETROì™€ ë™ì¼í•˜ê²Œ retriever finetuneë˜ì§€ ì•Šì€ ê²½ìš°ì˜ ì„±ëŠ¥ í™•ì¸</p> </li> <li> <p>Contriever, Spider: Unsupervised Mannerë¡œ í•™ìŠµëœ Retriever</p> </li> </ol> </li> </ol> </li> <li> <p><strong>Reranker</strong></p> <ol> <li> <p>RoBERTa-base ì‚¬ìš©</p> <ol> <li>í–¥í›„ ì‹¤í—˜ì—ì„œ í•™ìŠµ ì—¬ë¶€ì— ë”°ë¥¸ ì„±ëŠ¥ ì‹¤í—˜ ì§„í–‰</li> </ol> </li> </ol> <p><span style="color:green"><strong>Retrieved Document Length: 256</strong></span></p> </li> </ol> <p><br></p> <h2 id="4-2-effectiveness-of-retriever">4-2. Effectiveness of Retriever</h2> <h3 id="4-2-1-ëª¨ë¸-ë³„-ralm-ì ìš©-ì‹œ-ì„±ëŠ¥-ë³€í™”s4-l32">4-2-1. ëª¨ë¸ ë³„ RALM ì ìš© ì‹œ ì„±ëŠ¥ ë³€í™”(s=4, l=32)</h3> <p><strong><em>ëª¨ë¸ í¬ê¸°ì™€ ê´€ê³„ì—†ì´ RALM ì ìš© ì‹œ ì„±ëŠ¥ì´ ê°œì„ ë¨</em></strong></p> <ul> <li> <p>BM25: RETRO ë° RAGì™€ ë‹¤ë¥´ê²Œ LMê³¼ í•¨ê»˜ í•™ìŠµëœ Retriever X, Sparse Retriever</p> </li> <li> <p>ëª¨ë“  ëª¨ë¸ì—ì„œ RALM ì ìš© ì‹œ PPLì´ ê°œì„ ë˜ëŠ” ëª¨ìŠµ</p> </li> <li> <p>í° ëª¨ë¸ w/o Retriever &lt; ì‘ì€ ëª¨ë¸ w/ Retriever</p> <ul> <li>OPT-66B w/o Retriever &lt; OPT-6.7B w/ Retriever</li> </ul> </li> </ul> <p><br></p> <h3 id="4-2-2-retrieval-ì¢…ë¥˜-ë³„-ì„±ëŠ¥-ì–‘ìƒ">4-2-2. Retrieval ì¢…ë¥˜ ë³„ ì„±ëŠ¥ ì–‘ìƒ</h3> <p><strong><em>Sparse Retrieverê°€ Dense Retrieverë³´ë‹¤ ë†’ì€ ì„±ëŠ¥ ë‹¬ì„± ê°€ëŠ¥</em></strong></p> <ul> <li> <p>Language Modeling íƒœìŠ¤í¬ì—ì„œ Sparse Retriever(BM25)ê°€ ê°€ì¥ ì¢‹ì€ ì„±ëŠ¥ ë‹¬ì„±</p> </li> <li> <p>ëª¨ë¸ í¬ê¸°ì— ê´€ê³„ì—†ì´ ë™ì¼í•œ ì–‘ìƒ ìœ ì§€</p> </li> <li> <p>Wikipedia(Spider), Wikepedia + CCNet(Contriever)ì˜ ê²½ìš° ë¹„ìŠ·í•œ ì„±ëŠ¥ ë„ì¶œ</p> <ul> <li>BM25ë³´ë‹¤ ì„±ëŠ¥ì´ ì¢‹ì§€ ì•Šìœ¼ë‚˜, Retrievalì„ ì‚¬ìš©í•˜ì§€ ì•Šì€ ê²½ìš°ë³´ë‹¤ ê°œì„ </li> </ul> </li> <li> <p>BERTì˜ ê²½ìš° ì„±ëŠ¥ ê°œì„  X</p> <ul> <li> <p>RETRO: BERTë¥¼ Freezeí•˜ì—¬ Retrieval Moduleë¡œì„œ í™œìš©</p> </li> <li> <p>RALM í”„ë ˆì„ì›Œí¬ì—ì„œ Retrievalì˜ ì„±ëŠ¥ì´ ì¤‘ìš”</p> </li> </ul> </li> </ul> <p><br></p> <h2 id="4-3-design-choice-of-ralm">4-3. Design Choice of RALM</h2> <h3 id="4-3-1-retrieval-stride">4-3-1. Retrieval Stride</h3> <p><strong><em>Strideì— ë”°ë¥¸ ì„±ëŠ¥ê³¼ ì†ë„ Trade-off ê´€ê³„ ì¡´ì¬ í™•ì¸</em></strong></p> <ul> <li> <p>Strideê°€ ì§§ì„ìˆ˜ë¡ ì„±ëŠ¥ì´ ê°œì„ ë˜ëŠ” ê²½í–¥ì„± í¬ì°©</p> </li> <li> <p>ì§§ì€ Retrieval Stride: ìì£¼ Retrieve â†’ í˜„ì¬ ìƒì„±í•˜ê³ ì í•˜ëŠ” ì •ë³´ì™€ ìœ ì‚¬í•œ ì •ë³´ë¥¼ Retrieveí•  ìˆ˜ ìˆìŒ</p> </li> </ul> <h3 id="4-3-2-retrieval-query-length">4-3-2. Retrieval Query Length</h3> <p><strong><em>ì ì ˆí•œ ê¸¸ì´ì˜ Query Lengthê°€ Retrieval íš¨ê³¼ ê²°ì •</em></strong></p> <ul> <li> <p>BM25 ì´ìš© ì‹œ Query Lengthì— ë”°ë¥¸ ì„±ëŠ¥ ë³€í™”</p> </li> <li> <p>Query Length=32ì¼ ë•Œ ìµœì ì˜ ì„±ëŠ¥ ë„ì¶œ</p> </li> <li> <p>Dense Retrieval ì‚¬ìš© ì‹œ 64 ê¸¸ì´ê°€ ìµœì </p> </li> <li> <p>ë„ˆë¬´ ê¸´ Query Length: Retrieveí•´ì•¼ í•˜ëŠ” ì •ë³´ê°€ í¬ì„</p> </li> <li> <p>ë„ˆë¬´ ì§§ì€ Query Length: Retrieveí•´ì•¼ í•˜ëŠ” ì •ë³´ê°€ ì¶©ë¶„íˆ ë°˜ì˜ X</p> </li> </ul> <p><br></p> <h2 id="4-4-effect-of-reranker">4-4. Effect of Reranker</h2> <h3 id="4-4-1-reranker-ì‚¬ìš©ì˜-íš¨ê³¼">4-4-1. Reranker ì‚¬ìš©ì˜ íš¨ê³¼</h3> <p><strong><em>w/o Retrieval &lt; w/ Retrieval &lt; w/ Reranker &lt; w/ Trained Reranker</em></strong></p> <ul> <li> <p>ëª¨ë“  ë°ì´í„° ë° ëª¨ë¸ì—ì„œ ë™ì¼í•œ ê²½í–¥ì„± í¬ì°©</p> <ul> <li> <p>Retrieval ì‚¬ìš©(top-1) ì‹œ ê°€ì¥ í° ì„±ëŠ¥ ê°œì„  í™•ì¸</p> </li> <li> <p>Reranker ì‚¬ìš©(top-16) ì‹œ ì¶”ê°€ì ì¸ ì„±ëŠ¥ ê°œì„  í™•ì¸</p> </li> </ul> </li> </ul> <p><br></p> <h3 id="4-4-2-reranker-íš¨ê³¼ì˜-ì›ì¸">4-4-2. Reranker íš¨ê³¼ì˜ ì›ì¸</h3> <p><em>**Retrieved Document ì¤‘ ìµœì„ ì˜ ë¬¸ì„œëŠ” ë”°ë¡œ ìˆë‹¤. **</em></p> <ul> <li> <p>Oracle: Top-16 document ì¤‘ ê°€ì¥ ì„±ëŠ¥ ê°œì„ ì´ í° Documentì˜ ì„±ëŠ¥</p> <ul> <li> <p>Retrieval íŠ¹ì„± ìƒ Top-1 Documentê°€ í•­ìƒ ìµœì„ ì˜ ë¬¸ì„œ X</p> </li> <li> <p>Document ì¤‘ ì‹¤ì œ ì„±ëŠ¥ ê°œì„ ì´ ë” ë„ì›€ì´ ë˜ëŠ” Docì„ íƒìƒ‰í•˜ëŠ” ì‘ì—…ì´ ì¤‘ìš”</p> </li> </ul> </li> </ul> <p><br></p> <h3 id="4-4-3-zero-shot-reranker">4-4-3. Zero-Shot Reranker</h3> <p><strong><em>Zero-shot Rerankerì˜ í¬ê¸°ëŠ” ì¤‘ìš”í•˜ì§€ ì•Šë‹¤</em></strong></p> <ul> <li> <p>Zero-shot Reranker: ì‚¬ì „í•™ìŠµëœ LMì„ ì´ìš©í•˜ì—¬ Reranking ì‘ì—… ìˆ˜í–‰</p> <ul> <li> <p>ì‹¤ì œ Language Modelingì„ ìˆ˜í–‰í•˜ëŠ” LMì¼ í•„ìš” X</p> <p>â‡’ ì‘ì€ LMì„ Rerankerë¡œ ì´ìš©í•œë‹¤ë©´ íš¨ìœ¨ì  reranking ê°€ëŠ¥</p> <p><br></p> </li> </ul> </li> </ul> <h2 id="4-5-open-domain-question-answering">4-5. Open-Domain Question Answering</h2> <h3 id="4-5-1-odqa-w-ralm">4-5-1. ODQA w/ RALM</h3> <p><em>**LLMì„ ODQAì— í™œìš©í•  ë•Œë„ RALMì€ ë§¤ìš° íš¨ê³¼ì ì´ë‹¤. **</em></p> <ul> <li> <p>DPR: NQì™€ TriviaQAë¡œ í•™ìŠµëœ Retriever</p> <ul> <li>ì´ì „ê³¼ ë‹¤ë¥´ê²Œ In-Domain Retriever í™œìš©</li> </ul> </li> <li> <p>RALMì„ í†µí•´ LLMì˜ Knowledge Intensive Task ì„±ëŠ¥ì„ ë¹„ì•½ì ìœ¼ë¡œ ì¦ê°€ì‹œí‚¬ ìˆ˜ ìˆìŒ</p> </li> </ul> <h3 id="4-5-2--of-document-for-odqa">4-5-2. # of Document for ODQA</h3> <p><em>**ODQAì—ì„œëŠ” Documentì˜ ìˆ˜ê°€ ë§ì„ í•„ìš”ê°€ ì—†ë‹¤. **</em></p> <ul> <li> <p>ë‹¤ì†Œ í˜¼ì¬ëœ ì‹¤í—˜</p> <ul> <li> <p>Retrieval: DPR</p> </li> <li> <p>ì´ì „ê³¼ ë‹¤ë¥´ê²Œ In-Domain Retriever: Retrieved Documentì˜ í’ˆì§ˆì´ Language Modeling ì‹œë³´ë‹¤ ì¢‹ì„ ìˆ˜ ë°–ì— ì—†ìŒ</p> <p>â‡’ Contriever, Spider ë“±ì˜ Unsupervised Dense Retriever ì‚¬ìš© ì‹œì—ë„ ë¹„ìŠ·í•œ ì„±ëŠ¥ ì–‘ìƒì´ ë‚˜íƒ€ë‚˜ëŠ”ì§€ í™•ì¸ í•„ìš”</p> </li> </ul> </li> <li> <p>ëª¨ë¸ í¬ê¸°ì™€ ê´€ê³„ì—†ì´ ì¼ê´€ëœ Optimal Document ìˆ˜ê°€ ì •í•´ì§(1, 2)</p> </li> </ul> <p><br></p> <h2 id="7-conclusion">7. Conclusion</h2> <p>ğŸ’¡ 1. Off-the-shelf Retrieverì„ ì´ìš©í•œ RAG í”„ë ˆì„ì›Œí¬ ìœ íš¨ì„± ì…ì¦</p> <ol> <li>RAG í”„ë ˆì„ì›Œí¬ ë‚´ ì„¤ê³„ ìš”ì†Œ(retriever, stride, reranker)ì— ëŒ€í•œ ì‹¤í—˜ ì§„í–‰</li> </ol> <ul> <li> <p>BM25: Language Modeling ì‹œ ê°•ë ¥í•œ Retriever baselineìœ¼ë¡œ ë™ì‘</p> <ul> <li> <p>ìµœê·¼ ì—°êµ¬ë˜ëŠ” ë‹¤ì–‘í•œ embedding modelë“¤ì´ ë” ë‚˜ì€ ì„±ëŠ¥ì„ ë³´ì„</p> <p>â†’ ëª¨ë¸ í¬ê¸° ì¦ê°€(~7B)ë¥¼ í†µí•œ ì¼ë°˜í™” Retrieval ì„±ëŠ¥ ê°œì„ </p> </li> </ul> </li> <li> <p>Off-the-Shelf Retrieverì˜ Language Modeling ì‹œì˜ ì„±ëŠ¥ ê°œì„  íš¨ê³¼ í™•ì¸</p> <ul> <li> <p>ê¸°ì¡´ ì—°êµ¬: Retrieverë¥¼ LMê³¼ í•¨ê»˜ í•™ìŠµ â†’ LLMê³¼ joint train ì‹œ ë§¤ìš° í° ë¹„ìš© ë°œìƒ</p> </li> <li> <p>ë³„ë„ë¡œ í•™ìŠµëœ Retriever or BM25ë¥¼ í™œìš©í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ì„±ëŠ¥ ê°œì„ ì´ ê°€ëŠ¥í•¨</p> </li> </ul> </li> <li> <p>ì´í›„ RAG ê¸°ë°˜ ì—°êµ¬ë“¤ì˜ baselineìœ¼ë¡œì„œ ë™ì‘í•˜ëŠ” ì—°êµ¬</p> </li> </ul> </div> </article> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <br> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'unknown-nlp/unknown-nlp.github.io',
        'data-repo-id': '',
        'data-category': 'Comments',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2025 You R. Name. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/al-folio/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/al-folio/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/al-folio/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/al-folio/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/al-folio/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/al-folio/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/al-folio/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/al-folio/assets/js/search-data.js"></script> <script src="/al-folio/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>