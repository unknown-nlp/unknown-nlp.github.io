---
categories:
- paper-reviews
date: '2025-01-02 00:00:00'
description: 논문 리뷰
giscus_comments: true
layout: post
related_posts: false
tags:
- gpt
- language-model
- llm
- paper-review
- reasoning
- reinforcement-learning
thumbnail: assets/img/posts/2025-01-02-deepseek-r1/thumbnail.jpg
title: DeepSeek R1
---

**논문 정보**
- **Date**: 2025-01-02
- **Reviewer**: 건우 김

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/d1bbd184-13ba-4e21-bdcb-e447e811a644/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=ecac84e83e49d82385cf62e548a5145c4e5fc8794447880e9fbe5eb54776c695&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

https://substack.com/home/post/p-153314921

# Introduction

최근에 post-training은 reasoning tasks, align/adapt to user preference 등 성능을 올리기 위해 많이 사용되고 있음. 특히 Reasoning capability 측면에서 보면 GPT-4-o1은 CoT의 reasoning process의 Length를 늘리며 **inference-time 관점에서 scaling-out한** 방법으로 처음 소개된 모델임. test-time scaling을 효과적으로 수행하기 위한 방법으로 다양한 선행 연구들이 있었지만, 이중에 어느 것도 o1과 같은 reasoning model의 성능을 달성하진 못했음.

본 연구에서는 Reinforcement Learning(RL)을 활용해서 Language Model의 reasoning 성능을 끌어올리는 방법을 타묵함. **연구의 주된 목표는 SFT 없이 RL만 활용해서 LLM의 reasoning capabilities를 키우는 것임.**

DeepSeek-V3-Base을 backbone model로 두고 GROP (RL)로만 학습시켜 **DeepSeek-R1-Zero**를 만들었고, 이것의 reasoning 성능은 AIME2024에서 GPT-4-o1의 86.7% 수준의 성능을 보여줌.

하지만 DeepSeek-R1-Zero의 output은 가독성이 떨어지기 때문에, 이를 해결하고자 multi-stage로 학습되는**DeepSeek-R1** 모델을 개발함. 본 모델의 학습 과정은 아래와 같음

1. Cold start

1. Reasoning-oriented RL

1. Rejection Sampling and SFT

1. RL for all Scenarios

더 나아가서 DeepSeek-R1을 활용하여 여러 Open-source models을 대상으로 distillation을 진행시켰고, large model에서 보이는 reasoning pattern이 small models들에 transfer가 어느 정도 되는 것을 보여줌.

본 논문의 주된 **Contributions**은 아래와 같음

1. **Post-Training: Large-Scale Reinforcement Learning on the Base Model**

1. **Distillation: Smaller Models Can Be Powerful Too**

# Approach

(논문의 내용과 jay alammar의 시각 자료를 활용함)

## Overview

DeepSeek-R1은 DeepSeek-V3에서 소개된 모델을 backbone으로 활용함. (이때, DeepSeek-V3의 final model이 아니고 base model임) 

DeepSeek-v3-Base에 SFT를 진행한 뒤에 RL을 적용하면 ⇒ DeepSeek-R1 !!

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/7ae7ac86-d002-4283-8843-3279166d1f2d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=707c796c04e4563417c7496390c537108f9acee38799ddfa0d70ebc1f780fe61&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

## 1. Long chains of reasoning SFT Data

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/a1f0db61-2165-490d-8d27-a921cd05af9f/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=96e6a66e400959b841e5a53e1af53e55ad866fbafeb32b5cad137ed3a7b07d55&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

SFT를 진행하기 위해서는 많은 양의 labeled data가 필요한데, 이 만큼의 양을 사람으로부터 얻기는 어렵다. 따라서, 이런 high quality의 long chain-of-thought reasoning examples을 얻기 위해서 “**Interim reasoning LLM**”을 별도로 학습시켜서 활요함.

## 2. An interim high-quality reasoning LLM (but worse at non-reasoning tasks)

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/ab9d3523-4c62-40a4-a4df-6968983d4e36/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=65970f46f63015ace56ad1b6a7f4b3cb5247c94a74bcf323f4ec8f23432e782a&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

Interim reasoning model을 별도로 학습시켜서 SFT data를 구축하는데 사용함. 이때, Interim reasoning model은 DeepSeek-R1-Zero과 비슷하게 구축이 됨. (DeepSeek-R1-Zero를 먼저 만들고 난 뒤에, 여기서 영감을 얻어 DeepSeek-R1을 개발함) 

## 3. Creating reasoning models with large-scale RL

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/3a327e6b-c04e-4ddb-887e-8fa581513791/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=915408f0cff284f689ed0dc26f8da04b30c9840b69ba941d0205885ce941dd8c&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

### **3.1 Large-Scale Reasoning-Oriented RL (R1-Zero)**

여기서 RL은 interim model을 학습시키기 위해 사용하고 해당 모델로 SFT reasoning samples을 구축함. 아래 table에서 보이는 바와 같이 R1-Zero는 o1과 비슷한 수준의 Reasoning 성능을 보여줬기에, 이에 영감을 받아 SFT reasoning samples을 구축하고자 함.

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/49d8aa3d-756b-4672-9c6d-45c3b1136c8b/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=b3029bc747953e5a4f92fd1bc40937f39676013fdcd87d7b3b834b077972cb01&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/40607f38-06a0-4651-92cf-2b63eaaa6bd8/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=40f47208c7c9ae26c753d2e183ef3d72ab372e6d8fe678641b7e99caa3bf2e1d&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

기존의 ML 모델들과 다르게, 더 이상 새로운 데이터를 추가하지 않아도 성능이 향상될 수 있음을 보여줌

1. 14.8 Billion high-quality tokens으로 학습한 base model이 있는데, 이미 많은 데이터로 학습시켰기 때문에, 단순히 더 많은 데이터를 추가한다고 해서 성능이 획기적으로 좋아지는 단계는 지났을 가능성이 큼

1. Reasoning 문제는 데이터 없이도 성능이 개선될 수 있음.

**Example**

> Write python code that takes a list of numbers, returns them in a sorted order, but also adds 42 at the start.

위 문제는 

- linter와 같은 software를 활용하여 생성된 코드가 python 문법을 따르는지 확인할 수 있음

- 코드가 실제로 실행되는지 테스트할 수 있음 (실행되지 않으면 잘못된 코드임을 확인함)

- 실행 속도(퍼포먼스) 측정 가능. 

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/0aff3e5d-79ce-4cb1-bc46-982879669fde/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=3d5b96d2d807b86bbb097be8deff6640b703e804c1edf0d8e4d498a827b38c46&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/ebd2a336-8301-47e6-9b22-7a449633aacf/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=aaefe11054f955bfc9fcade08103df113e19dbeba485f1caef3f613ac57e5952&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

이때 사용한 System message는 아래와 같음 (명시적으로 <think> tag 사이에 reasoning prcoess를 작성하라고 되어있지만, 논리 과정은 자율 형식)

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/21e9bb7f-55eb-4ff4-bd8e-59907f107ba3/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=d73ea523f76c96a994f06f4f0d6ef9142a5692ef52b78029b2e9d48c32ab2fac&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

RL과정에서 사용된 두 가지 rewards는 **accuracy reward** (답변이 맞는지 확인)과 **format rewards**( think, answer tag를 잘 사용하고 있는지)가 있고, GRPO 알고리즘을 활용하여 model을 update함

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/178ee3ee-ff6c-4141-a240-9f7029a23c24/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=a03e0d88c23dd76305e97b24cc49a2a63c36d3d8688aee31f4b2c0608d9253e3&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

### Group Relative Policy Optimization (GRPO)

**PPO**

Deepseekmath: Pushing the limits of mathematical reasoning in open language models. 참조

**Proximal Policy Optimization (PPO): Actor-Critic RL algorithm**

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/657227a3-9ba8-4d07-aedc-e396141571c6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=3467130e1cb2665444fe60a6a50f2118b4e547daf3471ab79269fc9916f8a7f2&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

PPO Advantage를 뜯어보면 아래와 같음

- Advantage는 Rt - V(st)로 산출됨

Gradient Update process

1. Actor update (PPO Objective function)

1. Critic update (Value function)

Actor update → Critic update

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/a549ae0f-a601-4da0-9ced-09d9e22759b3/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=e29cc965484ae7c090eba99ab43dd46ec64e3768e1064a1d2276a22a3490461f&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

- PPO에서는 별도의 critic model (=value function)을 사용하여 policy model의 행동을 평가하는데, critic model의 크기는 policy model과 동일하거나 비슷하기에 computational cost가 높은 단점이 있음

- critic model → group scores로 대체하여 baseline을 추정하는 방식

- **Core Ideas**

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/e4d59fb0-72ef-4ba6-a135-9a0697766814/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=506d25daf1718838c966bbd37088b21399c0abd8d9fd6f916cd47c19e0f434e1&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

(1) PPO의 Clip Trick을 활용함

(2) KL Divergence

(3) Advantage (Ai)

GRPO의 알고리즘은 아래와 같음

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/8fbc1ce4-75aa-4771-9a62-8bbde5b85f97/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113501Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=1719579b0c489ce70386c539299031bcaf4c6ce790bafede240a03654d8d38d6&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

### **3.2 Creating SFT reasoning data with the interim reasoning model**

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/656345a4-2e5c-449c-8b18-75cffaccc4a4/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=e3aa50d61cf90832000a826f1fb3e0b80a2c08f51cffbea97de9dd8414fd92df&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

1. **Cold Start**

1. **Reasoning-oriented Reinforcement Learning**

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/1316815f-b21e-41b2-9a8c-56adede22a90/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=7f06c0009381877eef466d0486a0c01f5f1d6015595737af509a5186313d6d0c&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

Interim model을 활용하여 600,000개 samples을 만들고 난 뒤에 DeepSeek-V3에서 사용한 SFT dataset samples 200,000개와 결합하여 최종적으로 **800,000 SFT samples** 구축

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/a260d06b-5cb7-4721-b7ff-f6ab062ae58b/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=89d4ac26ae4a1e03e588234577dfee442d453f8446647b0f8469f0ae0540da06&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

### 3.3 General RL training phase

위와 같이 SFT로 학습된 R1은 reasoning 및 non-reasoning tasks를 잘 수행하지만, 더 다양한 applications에 확장시키기 위해서 Llama2에서 사용한 helpfulness / safety reward model을 활용하여 일반적인 RL 학습을 진행함

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/ac3fecb2-56b8-4bd4-87ad-4a3739e57076/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=4a6748c9bdb6c8611a7356e61019e53a00d488d3ec1ddb2ae03698923115334f&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

여기서는 기존에 사용하던 reasoning modeling을 위한 reward verifier와 llama2에서 사용한 reward model을 **동시에 같이 사용함**

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/08d10c3b-d70b-4859-9b04-d770ca4d8e35/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=27f934a090fb8a9f13af4ac4292619fbb70767aeec581aed44c53da7347e330f&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

### *Distillation: Empower Small Models with Reasoning Capability

DeepSeek-R1은 671B params를 갖고 있기 때문에, 일반 hardware에서 사용하기에 어려움이 있음. 본 연구에서 R1의 reasoning quality를 Qwen-32B와 같은 open source model로 distillation을 진행함.

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/4fa8a5bc-28f8-471d-953c-8dd523435191/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=d3a5c81e581a4b223fa67691721db1507ca779c8cc09c424c28dd4359608b93d&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

800,000개의 reasoning 및 non-reasoning samples로 학습을 진행함

# Experiment

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/a63b8d2b-6a3b-4e6a-be3d-2b2a8d7b05e1/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=8bd7cc05d884b62b833bb8dd934413bfb7c45ef09ee7eb0e050f4b9659bb8546&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/ebd9e2f7-809c-483d-86be-827095e7d887/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=9a736c465486b3d0c7aa8083b0bc67f015c86132a780db8116c450cd64035536&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

# Discussion

## Distillation vs. Reinforcement Learning

*Can the model achieve comparable performance through the large-scale RL training discussed in the paper without distillation?*

→ Qwen32B-base로 실험한 결과 Zero모델은 R1에 비해 다소 떨어진 성능을 보이고 QwQ32B와 비슷한 성능을 보여줌

![Image](https://prod-files-secure.s3.us-west-2.amazonaws.com/3acbc979-3f43-48f4-8683-229c6104ec76/631c1b3b-e20b-4c2c-b151-b411522e1e8c/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662ULCVXEP%2F20250810%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250810T113502Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEC3HZOC5H326YrkTD6Y2c1SknbtMJ1rCM%2Bnk3SjpjiEAiEAm1Kg9eEI0Lh3R%2Bf242etPZhm%2FHCfCnHmkP5feoMaXGwqiAQI1P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDEPnLD9td51nH%2Fk2zSrcA7j2evo8sN5Fy3NOO8SgVgNOeXj71rMczSfuyBB2pihF1frG4En9b6MwtYj%2FTTkiVvLZ5%2FudtDonq06xQWvQZni5SAcoRIW4uMm3CUhnjQ%2BhFT7nEIhQ2hz9%2BM0f2juHskJjqU16M1dRyuFokfXnZOwHdn5DQyAA258NOjchcGsxc5deaz%2FybsszhJimsV4dctyAOHaTONmrTz2ioxgXJMzDae4p3yQV1IKS%2FDyrMefkn0ajTT2BJdMZhZZQWds5ZaQI%2FpGAu1xAqrfr%2FXhpsX56LD6K3i%2B1F5u%2B7WwD0ov6rmqCzBJjagvAADqMt4FxeD8WJ4bfE642Nspnz1dQ8G5DCCn7QDu0d9KEJaQ3kSx8CWjKHNeP48vjpfCDCCwz279jxpvmkjU9w3RLPlwtyR3wkTdMMPH5ArYg7oG1LP70egOKjtqqC3pQYzXt86NGhY6hRgGy05k8wQey59WGXSLJeYiDcIKaSybMXkhMY1x2UEBTX2h0AerJ0q184GvNP99SOfQLqOjWsQg7ZZbMAO0NklZTgvDCXJTB0FN6bLkuqhpFhLPQ%2F2HQBC1sB2Mrz4cqDXodNW8X0SNXOlRCb%2BDzr0Vg1jfRZqg%2F6e1M8VxFV6dFfHw1Ve9BY%2FaMMKT%2F4cQGOqUByJmZWT57R3%2FxbEMm0fsg8jkmAJI4mw%2FkrhbGNZH0mCO83MP6%2FQ0uElTAnGk5LzNFvWOxOrSnEAe7y%2Bxzp65QZQD7nmOt%2BEvnkhKpxVGx%2Bw0b3ZQcZ2R4%2BUqku49YB5QSGG6oNMeYDnbDI5jGXoOy8zVepjf%2FqMCW6O5sCw0NzfP%2FFOgbyGxpTfJ8wZ5%2FjT3HOJ9ovVK1DZj0UB%2FvVH%2F8EGNX%2FmQb&X-Amz-Signature=3910e8984676f3baca3870358aad6880fcbcecfa8e41ee7d9dcca5fda291c741&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)
